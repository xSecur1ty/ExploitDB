<?php 
    /*
        [+] Title    : Exploit-DB SearchSploit (php v.1b);
        [+] Coded By : xSecurity ( twitter : @xseclabs );
        [+] Date     : 15 jun 2018
        [+] Note     : Maybe Useful For Coders And Security Researchers .
        [!] Useage   : php file.php [com_jce or sqli or xss or lfi ] etc.. 
        [*] example  : php file.php com_upload
        [c] you can use this function for your codes but mention my name .
     */
    # https://github.com/offensive-security/exploit-database/blob/master/files_exploits.csv
    set_time_limit(0);
    ini_set('memory_limit', '-1');
    if(count($argv)<=1) {
        print("
               __                      _ _        
        __  __/ _\ ___  ___ _   _ _ __(_) |_ _   _
        \ \/ /\ \ / _ \/ __| | | | '__| | __| | | |
         >  < _\ \  __/ (__| |_| | |  | | |_| |_| |
        /_/\_\\__/\___|\___|\__,_ |_|  |_|\__|\__, |
                                             |___/ExploitDB SearchSploit PHP ver.1b =D
        \t[+] Coded By : xSecurity ( twitter : @xseclabs );
        \t[+] Date     : 16 jun 2018
        \t[+] Note     : Maybe Useful For Coders And Security Researchers .
        \t[!] Useage   : php {$argv[0]} [com_jce or sqli or xss or lfi ] etc.. 
        \t[*] example  : php {$argv[0]} sqli
        \t[c] you can use this function for your codes but mention my name .\n");
        die();
    }
    ExploitDB($argv[1]);    
    function ExploitDB($search) {
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, "https://raw.githubusercontent.com/offensive-security/exploit-database/master/files_exploits.csv");
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.112 Safari/534.30');
        $output = curl_exec($ch);
        curl_close($ch);
        # 9,exploits/windows/dos/9.c,"Apache 2.x - Memory Leak",2003-04-09,"Matthew Murphy",dos,windows,
        $replace = preg_replace('#,exploits/#', '|exploits/', $output);
        $x = explode('|', $replace);
        
        $store = array();
        foreach(preg_grep("/{$search}/i", $x) as $k => $v) {
            $store[] = $v;
        }
        $s_r = array("exploits/php/webapps/" => "\t[+] URL: https://www.exploit-db.com/exploits/", 
                     ".txt" => "\n", 
                     ".php" => "\n",
                     ".py" => "\n",
                     ".pl" => "\n",
                     ".rb" => "\n",
                     "," => "|");
        print "\n\t[+++++++++++++++++++++++++xSecurity SearchSploit+++++++++++++++++++++++++]\n";
        foreach($store as $bug) { 
            print "\t".str_replace(array_keys($s_r), array_values($s_r), $bug)."\n";
        }
        print "\n\t[+++++++++++++++++++++++++xSecurity SearchSploit+++++++++++++++++++++++++]\n";
    }


?>
