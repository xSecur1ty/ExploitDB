<?php 
    /*
        [+] Title    : Exploit-DB SearchSploit (php v.1b);
        [+] Coded By : xSecurity ( twitter : @xseclabs );
        [+] Date     : 16 jun 2018
        [+] Note     : Maybe Useful For Coders And Security Researchers .
        - This Is Function You Can Work On it 
     */
    set_time_limit(0);
    ini_set('memory_limit', '-1');

    ExploitDB("sqli"); # searcher 

    function ExploitDB($search) {
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, "https://raw.githubusercontent.com/offensive-security/exploit-database/master/files_exploits.csv");
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.112 Safari/534.30');
        $output = curl_exec($ch);
        curl_close($ch);
        # 9,exploits/windows/dos/9.c,"Apache 2.x - Memory Leak",2003-04-09,"Matthew Murphy",dos,windows,
        $replace = preg_replace('#,exploits/#', '|exploits/', $output);
        $x = explode('|', $replace);
        
        $store = array();
        foreach(preg_grep("/{$search}/i", $x) as $k => $v) {
            $store[] = $v;
        }
        print_r($store);
    }


?>
